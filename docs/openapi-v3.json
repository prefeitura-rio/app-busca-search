{
  "openapi": "3.0.0",
  "info": {
    "description": "API para busca textual e vetorial usando Typesense e embeddings gerados via Google Gemini",
    "title": "Mecanismo de Busca API",
    "termsOfService": "http://swagger.io/terms/",
    "contact": {
      "name": "Prefeitura do Rio de Janeiro",
      "url": "https://prefeitura.rio",
      "email": "contato@prefeitura.rio"
    },
    "license": {
      "name": "Apache 2.0",
      "url": "http://www.apache.org/licenses/LICENSE-2.0.html"
    },
    "version": "1.0"
  },
  "paths": {
    "/api/v1/admin/services": {
      "get": {
        "description": "Lista serviços com paginação e filtros opcionais. Cada serviço na resposta inclui campos plaintext gerados automaticamente (resumo_plaintext, resultado_solicitacao_plaintext, descricao_completa_plaintext, documentos_necessarios_plaintext, instrucoes_solicitante_plaintext) que removem toda formatação markdown.",
        "tags": [
          "admin"
        ],
        "summary": "Lista serviços com paginação e filtros",
        "parameters": [
          {
            "description": "Página",
            "name": "page",
            "in": "query",
            "schema": {
              "type": "integer",
              "default": 1
            }
          },
          {
            "description": "Resultados por página",
            "name": "per_page",
            "in": "query",
            "schema": {
              "type": "integer",
              "default": 10
            }
          },
          {
            "description": "Status do serviço (0=Draft, 1=Published)",
            "name": "status",
            "in": "query",
            "schema": {
              "type": "integer"
            }
          },
          {
            "description": "Filtrar por autor",
            "name": "author",
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "description": "Filtrar por tema geral",
            "name": "tema_geral",
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "description": "Filtrar por aguardando aprovação",
            "name": "awaiting_approval",
            "in": "query",
            "schema": {
              "type": "boolean"
            }
          },
          {
            "description": "Filtrar por serviços gratuitos",
            "name": "is_free",
            "in": "query",
            "schema": {
              "type": "boolean"
            }
          },
          {
            "description": "Filtrar por data de publicação (timestamp)",
            "name": "published_at",
            "in": "query",
            "schema": {
              "type": "integer"
            }
          },
          {
            "description": "Filtrar por nome do serviço",
            "name": "nome_servico",
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "description": "Campo para filtro dinâmico",
            "name": "field",
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "description": "Valor para filtro dinâmico (usado com field)",
            "name": "value",
            "in": "query",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/models.PrefRioServiceResponse"
                }
              }
            }
          },
          "400": {
            "description": "Bad Request",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": {
                    "type": "string"
                  }
                }
              }
            }
          },
          "500": {
            "description": "Internal Server Error",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": {
                    "type": "string"
                  }
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      },
      "post": {
        "description": "Cria um novo serviço na collection prefrio_services_base. A resposta inclui campos plaintext gerados automaticamente (resumo_plaintext, resultado_solicitacao_plaintext, descricao_completa_plaintext, documentos_necessarios_plaintext, instrucoes_solicitante_plaintext) que removem toda formatação markdown.",
        "tags": [
          "admin"
        ],
        "summary": "Cria um novo serviço",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/models.PrefRioServiceRequest"
              }
            }
          },
          "description": "Dados do serviço",
          "required": true
        },
        "responses": {
          "201": {
            "description": "Created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/models.PrefRioService"
                }
              }
            }
          },
          "400": {
            "description": "Bad Request",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": {
                    "type": "string"
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": {
                    "type": "string"
                  }
                }
              }
            }
          },
          "500": {
            "description": "Internal Server Error",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": {
                    "type": "string"
                  }
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/api/v1/admin/services/{id}": {
      "get": {
        "description": "Busca um serviço específico por ID. A resposta inclui campos plaintext gerados automaticamente (resumo_plaintext, resultado_solicitacao_plaintext, descricao_completa_plaintext, documentos_necessarios_plaintext, instrucoes_solicitante_plaintext) que removem toda formatação markdown.",
        "tags": [
          "admin"
        ],
        "summary": "Busca um serviço por ID",
        "parameters": [
          {
            "description": "ID do serviço",
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/models.PrefRioService"
                }
              }
            }
          },
          "400": {
            "description": "Bad Request",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": {
                    "type": "string"
                  }
                }
              }
            }
          },
          "404": {
            "description": "Not Found",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": {
                    "type": "string"
                  }
                }
              }
            }
          },
          "500": {
            "description": "Internal Server Error",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": {
                    "type": "string"
                  }
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      },
      "put": {
        "description": "Atualiza um serviço existente. A resposta inclui campos plaintext gerados automaticamente (resumo_plaintext, resultado_solicitacao_plaintext, descricao_completa_plaintext, documentos_necessarios_plaintext, instrucoes_solicitante_plaintext) que removem toda formatação markdown.",
        "tags": [
          "admin"
        ],
        "summary": "Atualiza um serviço existente",
        "parameters": [
          {
            "description": "ID do serviço",
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/models.PrefRioServiceRequest"
              }
            }
          },
          "description": "Dados atualizados do serviço",
          "required": true
        },
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/models.PrefRioService"
                }
              }
            }
          },
          "400": {
            "description": "Bad Request",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": {
                    "type": "string"
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": {
                    "type": "string"
                  }
                }
              }
            }
          },
          "404": {
            "description": "Not Found",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": {
                    "type": "string"
                  }
                }
              }
            }
          },
          "500": {
            "description": "Internal Server Error",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": {
                    "type": "string"
                  }
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      },
      "delete": {
        "description": "Deleta um serviço",
        "tags": [
          "admin"
        ],
        "summary": "Deleta um serviço",
        "parameters": [
          {
            "description": "ID do serviço",
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "No Content"
          },
          "400": {
            "description": "Bad Request",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": {
                    "type": "string"
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": {
                    "type": "string"
                  }
                }
              }
            }
          },
          "404": {
            "description": "Not Found",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": {
                    "type": "string"
                  }
                }
              }
            }
          },
          "500": {
            "description": "Internal Server Error",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": {
                    "type": "string"
                  }
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/api/v1/admin/services/{id}/publish": {
      "patch": {
        "description": "Publica um serviço alterando seu status para 1 e awaiting_approval para false. Opcionalmente, pode criar um tombamento se fornecidos os parâmetros origem e id_servico_antigo",
        "tags": [
          "admin"
        ],
        "summary": "Publica um serviço (altera status para 1 e marca como aprovado)",
        "parameters": [
          {
            "description": "ID do serviço",
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "description": "Origem do serviço antigo (1746_v2_llm ou carioca-digital_v2_llm) para criar tombamento",
            "name": "origem",
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "description": "ID do serviço antigo para criar tombamento",
            "name": "id_servico_antigo",
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "description": "Observações sobre o tombamento",
            "name": "observacoes",
            "in": "query",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/models.PrefRioService"
                }
              }
            }
          },
          "400": {
            "description": "Bad Request",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": {
                    "type": "string"
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": {
                    "type": "string"
                  }
                }
              }
            }
          },
          "404": {
            "description": "Not Found",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": {
                    "type": "string"
                  }
                }
              }
            }
          },
          "500": {
            "description": "Internal Server Error",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": {
                    "type": "string"
                  }
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/api/v1/admin/services/{id}/rollback": {
      "post": {
        "description": "Cria uma nova versão que restaura o estado de uma versão anterior (git-revert style)",
        "tags": [
          "versions"
        ],
        "summary": "Realiza rollback de um serviço para uma versão anterior",
        "parameters": [
          {
            "description": "ID do serviço",
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/models.RollbackRequest"
              }
            }
          },
          "description": "Dados do rollback",
          "required": true
        },
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/models.PrefRioService"
                }
              }
            }
          },
          "400": {
            "description": "Bad Request",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": {
                    "type": "string"
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": {
                    "type": "string"
                  }
                }
              }
            }
          },
          "404": {
            "description": "Not Found",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": {
                    "type": "string"
                  }
                }
              }
            }
          },
          "500": {
            "description": "Internal Server Error",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": {
                    "type": "string"
                  }
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/api/v1/admin/services/{id}/unpublish": {
      "patch": {
        "description": "Despublica um serviço alterando seu status para 0 e awaiting_approval para true",
        "tags": [
          "admin"
        ],
        "summary": "Despublica um serviço (altera status para 0 e marca como aguardando aprovação)",
        "parameters": [
          {
            "description": "ID do serviço",
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/models.PrefRioService"
                }
              }
            }
          },
          "400": {
            "description": "Bad Request",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": {
                    "type": "string"
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": {
                    "type": "string"
                  }
                }
              }
            }
          },
          "404": {
            "description": "Not Found",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": {
                    "type": "string"
                  }
                }
              }
            }
          },
          "500": {
            "description": "Internal Server Error",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": {
                    "type": "string"
                  }
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/api/v1/admin/services/{id}/versions": {
      "get": {
        "description": "Retorna o histórico completo de versões de um serviço com paginação",
        "tags": [
          "versions"
        ],
        "summary": "Lista todas as versões de um serviço",
        "parameters": [
          {
            "description": "ID do serviço",
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "description": "Página",
            "name": "page",
            "in": "query",
            "schema": {
              "type": "integer",
              "default": 1
            }
          },
          {
            "description": "Resultados por página",
            "name": "per_page",
            "in": "query",
            "schema": {
              "type": "integer",
              "default": 10
            }
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/models.VersionHistory"
                }
              }
            }
          },
          "400": {
            "description": "Bad Request",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": {
                    "type": "string"
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": {
                    "type": "string"
                  }
                }
              }
            }
          },
          "500": {
            "description": "Internal Server Error",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": {
                    "type": "string"
                  }
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/api/v1/admin/services/{id}/versions/compare": {
      "get": {
        "description": "Retorna as diferenças entre duas versões",
        "tags": [
          "versions"
        ],
        "summary": "Compara duas versões de um serviço",
        "parameters": [
          {
            "description": "ID do serviço",
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "description": "Versão de origem",
            "name": "from_version",
            "in": "query",
            "required": true,
            "schema": {
              "type": "integer"
            }
          },
          {
            "description": "Versão de destino",
            "name": "to_version",
            "in": "query",
            "required": true,
            "schema": {
              "type": "integer"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/models.VersionDiff"
                }
              }
            }
          },
          "400": {
            "description": "Bad Request",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": {
                    "type": "string"
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": {
                    "type": "string"
                  }
                }
              }
            }
          },
          "404": {
            "description": "Not Found",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": {
                    "type": "string"
                  }
                }
              }
            }
          },
          "500": {
            "description": "Internal Server Error",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": {
                    "type": "string"
                  }
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/api/v1/admin/services/{id}/versions/{version}": {
      "get": {
        "description": "Retorna os detalhes de uma versão específica",
        "tags": [
          "versions"
        ],
        "summary": "Busca uma versão específica de um serviço",
        "parameters": [
          {
            "description": "ID do serviço",
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "description": "Número da versão",
            "name": "version",
            "in": "path",
            "required": true,
            "schema": {
              "type": "integer"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/models.ServiceVersion"
                }
              }
            }
          },
          "400": {
            "description": "Bad Request",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": {
                    "type": "string"
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": {
                    "type": "string"
                  }
                }
              }
            }
          },
          "404": {
            "description": "Not Found",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": {
                    "type": "string"
                  }
                }
              }
            }
          },
          "500": {
            "description": "Internal Server Error",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": {
                    "type": "string"
                  }
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/api/v1/admin/tombamentos": {
      "get": {
        "description": "Lista tombamentos com paginação e filtros opcionais",
        "tags": [
          "tombamentos"
        ],
        "summary": "Lista tombamentos com paginação e filtros",
        "parameters": [
          {
            "description": "Página",
            "name": "page",
            "in": "query",
            "schema": {
              "type": "integer",
              "default": 1
            }
          },
          {
            "description": "Resultados por página",
            "name": "per_page",
            "in": "query",
            "schema": {
              "type": "integer",
              "default": 10
            }
          },
          {
            "description": "Filtrar por origem (1746_v2_llm ou carioca-digital_v2_llm)",
            "name": "origem",
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "description": "Filtrar por criador",
            "name": "criado_por",
            "in": "query",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/models.TombamentoResponse"
                }
              }
            }
          },
          "400": {
            "description": "Bad Request",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": {
                    "type": "string"
                  }
                }
              }
            }
          },
          "500": {
            "description": "Internal Server Error",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": {
                    "type": "string"
                  }
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      },
      "post": {
        "description": "Cria um mapeamento de serviço antigo para serviço novo na collection tombamentos_overlay",
        "tags": [
          "tombamentos"
        ],
        "summary": "Cria um novo tombamento",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/models.TombamentoRequest"
              }
            }
          },
          "description": "Dados do tombamento",
          "required": true
        },
        "responses": {
          "201": {
            "description": "Created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/models.Tombamento"
                }
              }
            }
          },
          "400": {
            "description": "Bad Request",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": {
                    "type": "string"
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": {
                    "type": "string"
                  }
                }
              }
            }
          },
          "404": {
            "description": "Not Found",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": {
                    "type": "string"
                  }
                }
              }
            }
          },
          "409": {
            "description": "Conflict",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": {
                    "type": "string"
                  }
                }
              }
            }
          },
          "500": {
            "description": "Internal Server Error",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": {
                    "type": "string"
                  }
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/api/v1/admin/tombamentos/by-old-service": {
      "get": {
        "description": "Busca um tombamento pelo ID do serviço antigo e origem",
        "tags": [
          "tombamentos"
        ],
        "summary": "Busca tombamento por serviço antigo",
        "parameters": [
          {
            "description": "Origem (1746_v2_llm ou carioca-digital_v2_llm)",
            "name": "origem",
            "in": "query",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "description": "ID do serviço antigo",
            "name": "id_servico_antigo",
            "in": "query",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/models.Tombamento"
                }
              }
            }
          },
          "400": {
            "description": "Bad Request",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": {
                    "type": "string"
                  }
                }
              }
            }
          },
          "404": {
            "description": "Not Found",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": {
                    "type": "string"
                  }
                }
              }
            }
          },
          "500": {
            "description": "Internal Server Error",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": {
                    "type": "string"
                  }
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/api/v1/admin/tombamentos/{id}": {
      "get": {
        "description": "Busca um tombamento específico por ID",
        "tags": [
          "tombamentos"
        ],
        "summary": "Busca um tombamento por ID",
        "parameters": [
          {
            "description": "ID do tombamento",
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/models.Tombamento"
                }
              }
            }
          },
          "400": {
            "description": "Bad Request",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": {
                    "type": "string"
                  }
                }
              }
            }
          },
          "404": {
            "description": "Not Found",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": {
                    "type": "string"
                  }
                }
              }
            }
          },
          "500": {
            "description": "Internal Server Error",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": {
                    "type": "string"
                  }
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      },
      "put": {
        "description": "Atualiza um tombamento existente",
        "tags": [
          "tombamentos"
        ],
        "summary": "Atualiza um tombamento existente",
        "parameters": [
          {
            "description": "ID do tombamento",
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/models.TombamentoRequest"
              }
            }
          },
          "description": "Dados atualizados do tombamento",
          "required": true
        },
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/models.Tombamento"
                }
              }
            }
          },
          "400": {
            "description": "Bad Request",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": {
                    "type": "string"
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": {
                    "type": "string"
                  }
                }
              }
            }
          },
          "404": {
            "description": "Not Found",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": {
                    "type": "string"
                  }
                }
              }
            }
          },
          "500": {
            "description": "Internal Server Error",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": {
                    "type": "string"
                  }
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      },
      "delete": {
        "description": "Deleta um tombamento, fazendo com que o serviço antigo volte a aparecer normalmente",
        "tags": [
          "tombamentos"
        ],
        "summary": "Deleta um tombamento (reverte substituição)",
        "parameters": [
          {
            "description": "ID do tombamento",
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "No Content"
          },
          "400": {
            "description": "Bad Request",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": {
                    "type": "string"
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": {
                    "type": "string"
                  }
                }
              }
            }
          },
          "404": {
            "description": "Not Found",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": {
                    "type": "string"
                  }
                }
              }
            }
          },
          "500": {
            "description": "Internal Server Error",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": {
                    "type": "string"
                  }
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/api/v1/search": {
      "get": {
        "description": "Executa busca com 4 estratégias: keyword (textual), semantic (vetorial), hybrid (combinada) ou ai (agente inteligente)",
        "tags": [
          "search"
        ],
        "summary": "Busca unificada de serviços públicos",
        "parameters": [
          {
            "description": "Texto da busca",
            "name": "q",
            "in": "query",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "description": "Tipo de busca: keyword, semantic, hybrid ou ai",
            "name": "type",
            "in": "query",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "description": "Número da página (mínimo: 1)",
            "name": "page",
            "in": "query",
            "schema": {
              "type": "integer",
              "default": 1
            }
          },
          {
            "description": "Resultados por página (máximo: 100)",
            "name": "per_page",
            "in": "query",
            "schema": {
              "type": "integer",
              "default": 10
            }
          },
          {
            "description": "Incluir serviços inativos (status != 1)",
            "name": "include_inactive",
            "in": "query",
            "schema": {
              "type": "boolean",
              "default": false
            }
          },
          {
            "description": "Alpha para busca hybrid (0-1, default: 0.3)",
            "name": "alpha",
            "in": "query",
            "schema": {
              "type": "number",
              "default": 0.3
            }
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/models.SearchResponse"
                }
              }
            }
          },
          "400": {
            "description": "Bad Request",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": {
                    "type": "string"
                  }
                }
              }
            }
          },
          "500": {
            "description": "Internal Server Error",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": {
                    "type": "string"
                  }
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/api/v1/search/{id}": {
      "get": {
        "description": "Retorna os detalhes completos de um serviço específico",
        "tags": [
          "search"
        ],
        "summary": "Busca um serviço por ID",
        "parameters": [
          {
            "description": "ID do serviço",
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/models.ServiceDocument"
                }
              }
            }
          },
          "404": {
            "description": "Not Found",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": {
                    "type": "string"
                  }
                }
              }
            }
          },
          "500": {
            "description": "Internal Server Error",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": {
                    "type": "string"
                  }
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    }
  },
  "servers": [
    {
      "url": "https://services.pref.rio/app-busca-search",
      "description": "Production server"
    },
    {
      "url": "https://services.staging.app.dados.rio/app-busca-search",
      "description": "Staging server"
    }
  ],
  "components": {
    "schemas": {
      "models.AgentsConfig": {
        "type": "object",
        "properties": {
          "exclusive_for_agents": {
            "type": "boolean"
          },
          "tool_hint": {
            "type": "string"
          }
        }
      },
      "models.Button": {
        "type": "object",
        "properties": {
          "descricao": {
            "type": "string"
          },
          "is_enabled": {
            "type": "boolean"
          },
          "ordem": {
            "type": "integer"
          },
          "titulo": {
            "type": "string"
          },
          "url_service": {
            "type": "string"
          }
        }
      },
      "models.FieldChange": {
        "type": "object",
        "properties": {
          "field_name": {
            "type": "string",
            "maxLength": 20000
          },
          "new_value": {},
          "old_value": {},
          "value_type": {
            "description": "\"string\", \"int\", \"bool\", \"array\", \"object\"",
            "type": "string",
            "maxLength": 20000
          }
        }
      },
      "models.PrefRioService": {
        "type": "object",
        "required": [
          "autor",
          "custo_servico",
          "descricao_completa",
          "nome_servico",
          "orgao_gestor",
          "resultado_solicitacao",
          "resumo",
          "tema_geral",
          "tempo_atendimento"
        ],
        "properties": {
          "agents": {
            "$ref": "#/components/schemas/models.AgentsConfig"
          },
          "autor": {
            "type": "string",
            "maxLength": 20000
          },
          "awaiting_approval": {
            "type": "boolean"
          },
          "buttons": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/models.Button"
            }
          },
          "canais_digitais": {
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "canais_presenciais": {
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "created_at": {
            "type": "integer"
          },
          "custo_servico": {
            "type": "string",
            "maxLength": 20000
          },
          "descricao_completa": {
            "type": "string",
            "maxLength": 20000
          },
          "documentos_necessarios": {
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "embedding": {
            "type": "array",
            "items": {
              "type": "number"
            }
          },
          "extra_fields": {
            "type": "object",
            "additionalProperties": true
          },
          "fixar_destaque": {
            "type": "boolean"
          },
          "id": {
            "type": "string"
          },
          "instrucoes_solicitante": {
            "type": "string",
            "maxLength": 20000
          },
          "is_free": {
            "type": "boolean"
          },
          "last_update": {
            "type": "integer"
          },
          "legislacao_relacionada": {
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "nome_servico": {
            "type": "string",
            "maxLength": 20000
          },
          "orgao_gestor": {
            "type": "array",
            "minItems": 1,
            "items": {
              "type": "string"
            }
          },
          "publico_especifico": {
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "published_at": {
            "type": "integer"
          },
          "resultado_solicitacao": {
            "type": "string",
            "maxLength": 20000
          },
          "resumo": {
            "type": "string",
            "maxLength": 20000
          },
          "search_content": {
            "type": "string"
          },
          "servico_nao_cobre": {
            "type": "string",
            "maxLength": 20000
          },
          "status": {
            "description": "0=Draft, 1=Published",
            "type": "integer",
            "maximum": 1,
            "minimum": 0
          },
          "tema_geral": {
            "type": "string",
            "maxLength": 20000
          },
          "tempo_atendimento": {
            "type": "string",
            "maxLength": 20000
          }
        }
      },
      "models.PrefRioServiceRequest": {
        "type": "object",
        "required": [
          "nome_servico",
          "orgao_gestor",
          "publico_especifico",
          "resumo",
          "tema_geral"
        ],
        "properties": {
          "agents": {
            "$ref": "#/components/schemas/models.AgentsConfig"
          },
          "awaiting_approval": {
            "type": "boolean"
          },
          "buttons": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/models.Button"
            }
          },
          "canais_digitais": {
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "canais_presenciais": {
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "custo_servico": {
            "type": "string",
            "maxLength": 20000
          },
          "descricao_completa": {
            "type": "string",
            "maxLength": 20000
          },
          "documentos_necessarios": {
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "extra_fields": {
            "type": "object",
            "additionalProperties": true
          },
          "fixar_destaque": {
            "type": "boolean"
          },
          "instrucoes_solicitante": {
            "type": "string",
            "maxLength": 20000
          },
          "is_free": {
            "type": "boolean"
          },
          "legislacao_relacionada": {
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "nome_servico": {
            "type": "string",
            "maxLength": 20000
          },
          "orgao_gestor": {
            "type": "array",
            "minItems": 1,
            "items": {
              "type": "string"
            }
          },
          "publico_especifico": {
            "type": "array",
            "minItems": 1,
            "items": {
              "type": "string"
            }
          },
          "published_at": {
            "type": "integer"
          },
          "resultado_solicitacao": {
            "type": "string",
            "maxLength": 20000
          },
          "resumo": {
            "type": "string",
            "maxLength": 20000
          },
          "servico_nao_cobre": {
            "type": "string",
            "maxLength": 20000
          },
          "status": {
            "type": "integer",
            "maximum": 1,
            "minimum": 0
          },
          "tema_geral": {
            "type": "string",
            "maxLength": 20000
          },
          "tempo_atendimento": {
            "type": "string",
            "maxLength": 20000
          }
        }
      },
      "models.PrefRioServiceResponse": {
        "type": "object",
        "properties": {
          "found": {
            "type": "integer"
          },
          "out_of": {
            "type": "integer"
          },
          "page": {
            "type": "integer"
          },
          "services": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/models.PrefRioService"
            }
          }
        }
      },
      "models.RollbackRequest": {
        "type": "object",
        "required": [
          "to_version"
        ],
        "properties": {
          "change_reason": {
            "type": "string",
            "maxLength": 20000
          },
          "to_version": {
            "type": "integer",
            "minimum": 1
          }
        }
      },
      "models.SearchResponse": {
        "type": "object",
        "properties": {
          "metadata": {
            "description": "Para AI search",
            "type": "object",
            "additionalProperties": true
          },
          "page": {
            "type": "integer"
          },
          "per_page": {
            "type": "integer"
          },
          "results": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/models.ServiceDocument"
            }
          },
          "search_type": {
            "$ref": "#/components/schemas/models.SearchType"
          },
          "total_count": {
            "type": "integer"
          }
        }
      },
      "models.SearchType": {
        "type": "string",
        "enum": [
          "keyword",
          "semantic",
          "hybrid",
          "ai"
        ],
        "x-enum-varnames": [
          "SearchTypeKeyword",
          "SearchTypeSemantic",
          "SearchTypeHybrid",
          "SearchTypeAI"
        ]
      },
      "models.ServiceDocument": {
        "type": "object",
        "properties": {
          "category": {
            "type": "string"
          },
          "created_at": {
            "type": "integer"
          },
          "description": {
            "type": "string"
          },
          "id": {
            "type": "string"
          },
          "metadata": {
            "type": "object",
            "additionalProperties": true
          },
          "status": {
            "type": "integer"
          },
          "title": {
            "type": "string"
          },
          "updated_at": {
            "type": "integer"
          }
        }
      },
      "models.ServiceVersion": {
        "type": "object",
        "required": [
          "change_type",
          "created_by",
          "created_by_cpf",
          "service_id",
          "version_number"
        ],
        "properties": {
          "autor": {
            "type": "string",
            "maxLength": 20000
          },
          "awaiting_approval": {
            "type": "boolean"
          },
          "canais_digitais": {
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "canais_presenciais": {
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "change_reason": {
            "type": "string",
            "maxLength": 20000
          },
          "change_type": {
            "type": "string",
            "enum": [
              "create",
              "update",
              "publish",
              "unpublish",
              "delete",
              "rollback"
            ]
          },
          "changed_fields_json": {
            "description": "Campos de mudança (armazenados como JSON string no Typesense)",
            "type": "string",
            "maxLength": 20000
          },
          "created_at": {
            "type": "integer"
          },
          "created_by": {
            "type": "string",
            "maxLength": 20000
          },
          "created_by_cpf": {
            "type": "string",
            "maxLength": 20000
          },
          "custo_servico": {
            "type": "string",
            "maxLength": 20000
          },
          "descricao_completa": {
            "type": "string",
            "maxLength": 20000
          },
          "documentos_necessarios": {
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "embedding_hash": {
            "description": "Hash do embedding para verificação (não armazenamos o embedding completo)",
            "type": "string",
            "maxLength": 20000
          },
          "fixar_destaque": {
            "type": "boolean"
          },
          "id": {
            "type": "string"
          },
          "instrucoes_solicitante": {
            "type": "string",
            "maxLength": 20000
          },
          "is_free": {
            "type": "boolean"
          },
          "is_rollback": {
            "type": "boolean"
          },
          "legislacao_relacionada": {
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "nome_servico": {
            "description": "Snapshot completo do serviço (sem embedding para economizar espaço)",
            "type": "string",
            "maxLength": 20000
          },
          "orgao_gestor": {
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "previous_version": {
            "type": "integer"
          },
          "publico_especifico": {
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "published_at": {
            "type": "integer"
          },
          "resultado_solicitacao": {
            "type": "string",
            "maxLength": 20000
          },
          "resumo": {
            "type": "string",
            "maxLength": 20000
          },
          "rollback_to_version": {
            "type": "integer"
          },
          "search_content": {
            "type": "string",
            "maxLength": 20000
          },
          "service_id": {
            "type": "string",
            "maxLength": 20000
          },
          "servico_nao_cobre": {
            "type": "string",
            "maxLength": 20000
          },
          "status": {
            "type": "integer"
          },
          "tema_geral": {
            "type": "string",
            "maxLength": 20000
          },
          "tempo_atendimento": {
            "type": "string",
            "maxLength": 20000
          },
          "version_number": {
            "type": "integer"
          }
        }
      },
      "models.Tombamento": {
        "type": "object",
        "required": [
          "criado_por",
          "id_servico_antigo",
          "id_servico_novo",
          "origem"
        ],
        "properties": {
          "criado_em": {
            "type": "integer"
          },
          "criado_por": {
            "type": "string",
            "maxLength": 20000
          },
          "id": {
            "type": "string"
          },
          "id_servico_antigo": {
            "type": "string",
            "maxLength": 20000
          },
          "id_servico_novo": {
            "type": "string",
            "maxLength": 20000
          },
          "observacoes": {
            "type": "string",
            "maxLength": 20000
          },
          "origem": {
            "type": "string",
            "enum": [
              "1746_v2_llm",
              "carioca-digital_v2_llm"
            ]
          }
        }
      },
      "models.TombamentoRequest": {
        "type": "object",
        "required": [
          "id_servico_antigo",
          "id_servico_novo",
          "origem"
        ],
        "properties": {
          "id_servico_antigo": {
            "type": "string",
            "maxLength": 20000
          },
          "id_servico_novo": {
            "type": "string",
            "maxLength": 20000
          },
          "observacoes": {
            "type": "string",
            "maxLength": 20000
          },
          "origem": {
            "type": "string",
            "enum": [
              "1746_v2_llm",
              "carioca-digital_v2_llm"
            ]
          }
        }
      },
      "models.TombamentoResponse": {
        "type": "object",
        "properties": {
          "found": {
            "type": "integer"
          },
          "out_of": {
            "type": "integer"
          },
          "page": {
            "type": "integer"
          },
          "tombamentos": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/models.Tombamento"
            }
          }
        }
      },
      "models.VersionDiff": {
        "type": "object",
        "properties": {
          "change_type": {
            "type": "string"
          },
          "changed_at": {
            "type": "integer"
          },
          "changed_by": {
            "type": "string"
          },
          "changes": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/models.FieldChange"
            }
          },
          "from_version": {
            "type": "integer"
          },
          "to_version": {
            "type": "integer"
          }
        }
      },
      "models.VersionHistory": {
        "type": "object",
        "properties": {
          "found": {
            "type": "integer"
          },
          "out_of": {
            "type": "integer"
          },
          "page": {
            "type": "integer"
          },
          "versions": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/models.ServiceVersion"
            }
          }
        }
      }
    },
    "securitySchemes": {
      "bearerAuth": {
        "type": "http",
        "scheme": "bearer",
        "bearerFormat": "JWT"
      }
    }
  }
}
